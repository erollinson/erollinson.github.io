---
title: "A summary of the tweets generated at Botany 2022 (#Botany2022)"
author: "E.J. Rollinson"
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
editor_options: 
  chunk_output_type: console
---  

```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
#Setup Libraries

#library(remotes) #Uncomment these lines if fonts need to be imported; these lines don't need to run every time the document is knit after that. Code below assumes Open Sans installed locally and is available to be imported.
#remotes::install_version("Rttf2pt1", version = "1.3.8") #uncomment these lines if fonts need to be imported

library(extrafont) 
#font_import() #uncomment these lines if fonts need to be imported
#extrafont::loadfonts(device="win") #uncomment these lines if fonts need to be imported

#library(devtools) #uncomment these two lines if tweetrmd needs to be installed
#devtools::install_github("gadenbuie/tweetrmd")

#Load Libraries
library(dplyr)
library(ggplot2)
library(knitr)
library(tidyr)
library(RColorBrewer)
library(tweetrmd)
library(htmltools)
library(purrr)
library(stringr)
library(rmarkdown)

pal <- brewer.pal(9, "YlGnBu") #define colors for plots below

#The comments below show how to use rtweet to download Twitter data. You will need to create an app at https://dev.twitter.com/ to get Twitter API OAuth values that fill into the spaces indicated below. This code needs to run to generate the csv used in creating this document, but should be commented out to knit the final product. 

#There is a limit to how many tweets can be returned, and also how far back in time the Twitter API will search (approximately the past 6-10 days from time of search). To save tweets for a long event and/or a very commonly used search term, I recommend running this search and saving new files regularly, and compiling them all at the end. The compiled .csv can then be reimported below. See tweetscrape_blank.Rmd in same GitHub project for a template.

#Please note that this code works with rtweet 0.7.0 as of 7/28/2022, but the same code fails with rtweet > 1.0.0 - the data format produced by search_tweets, has changed dramatically as of 1.0.0 (https://ropensci.org/blog/2022/07/21/rtweet-1-0-0/), so the entirety of the code below needs to be rewritten to accommodate that. Notably, this also includes the loss of the ability to save the downloaded tweets as a csv. In this GitHub project, tweetscrape_blank.Rmd contains a section that has started to test use of rtweet 1.0.2, but isn't yet fully functional.

#load libraries
library(rtweet)
library(tidyverse)
library(lubridate)
library(tidytext)


#Pass your keys to API

# appname <- "YourAppName"
# key <- "YourKey"
# secret <- "YourSecretKey"
# access_token <- "YourAccessToken"
# access_secret <- "YourSecretAccessToken"
# 
# twitter_token <-create_token(
#   app = appname,
#   consumer_key = key,
#   consumer_secret = secret,
#   access_token = access_token,
#   access_secret = access_secret)
# create_token() is deprecated in rtweet 1.0.0 - authentication should occur via browser popup when running search_tweets for the first time if there is no authentication token stored
#Save tweets to csv

# tweets<-search_tweets(q = "#Botany2022", n=10000, retryonratelimit = TRUE)
# save_as_csv(tweets, "Botany2022FullWeek.csv")


#Import csv of tweets 

dt_tweets <- read.csv("Botany2022FullWeek.csv", stringsAsFactors = FALSE)
dt_tweets$created_at <- as.Date(dt_tweets$created_at)

#Filter to original tweets only (no retweets)
uniques <- dt_tweets %>%
  filter(is_retweet=="FALSE")

```

## 1. About this document
This document was produced by [Emily J. Rollinson](http://rollinsonecology.com) ([\@ejrollinson](https://twitter.com/ejrollinson) on Twitter). 

The code generating this document was originally developed by [Francois Michonneau](https://github.com/fmichonneau) ([\@fmic_](https://twitter.com/fmic_) on Twitter) for the 2015 Evolution meeting and can be found [here](https://github.com/fmichonneau/evol2015-tweets). 

I originally adapted this code for the 2015 Ecological Society of America meeting (#ESA100) in Baltimore, MD, and have since reproduced it for [a series of ESA and Botany meetings](https://erollinson.github.io/). I  modified it in 2020 to use the rtweet package instead of twitteR to aggregate tweets, updated the code used to generate the wordcloud, and modified the formatting of the plots. In 2021, I updated the code to embed top tweets using [tweetrmd](https://github.com/gadenbuie/tweetrmd). A new section was added in 2022 following [this suggestion](https://twitter.com/AzKlymiuk/status/1553464116831928320) from [Az Klymiuk](https://twitter.com/AzKlymiuk).

Tweets using the hashtag #Botany2022 were aggregated from Twitter using the R package [rtweet](https://cran.r-project.org/web/packages/rtweet/index.html) and the Twitter API. The summary statistics are static as of 09:00 AM EDT 7/28/2022. Additional tweets, retweets, and likes after that point are not included in the summary, although embedded tweets are "live" and up-to-date.

This document was generated using RMarkdown, and the source is [available on GitHub](https://github.com/erollinson/erollinson.github.io).

This document (and associated code) is released under a CC0 license.


## 2. Basic summary

Of the `r nrow(dt_tweets)` tweets tagged #Botany2022 between `r min(dt_tweets$created_at)` and `r max(dt_tweets$created_at)`:

|Description | n |
|------------|---|
|Total of original tweets (no retweets): | `r sum(!dt_tweets$is_retweet)`|
|Number of users who tweeted (including retweeting): | `r n_distinct(dt_tweets$screen_name)`|
|Number of users who tweeted (no retweets): | `r n_distinct(uniques$screen_name)`|

## 3. Building a Botany Twitter community

The figures in this section were made following [this suggestion](https://twitter.com/AzKlymiuk/status/1553464116831928320) from [Az Klymiuk](https://twitter.com/AzKlymiuk). Thank you!

### Number of users retweeted

This figure summarizes breadth of retweeting among users of the #Botany2022 hashtag during the conference - how many different users did a given account retweet?

```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing the number of different accounts retweeted by each user, within tweets using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the number of accounts that a particular user retweeted within this hashtag, for the 50 users that retweeted the most other accounts. For instance, SarraceniaMason retweeted tweets using the #Botany2022 hashtag from 120 other accounts. Top 5 - @SarraceniaMason (120), @Bethbo_beth (85), @MartineBotany (69), @angelajmcd (67), @AnnaScharnagl (58). The values in this figure are also included in the plain text tables lower on this page."}

retweeters <- dt_tweets %>% 
  filter(is_retweet ==TRUE) %>%
  group_by(screen_name) %>%
  summarize(users_rtd = n_distinct(retweet_screen_name),
            .groups="drop_last") %>%
  arrange(desc(users_rtd)) %>%
  slice(1:50)

ggplot(retweeters) + 
  geom_bar(aes(x = reorder(screen_name, users_rtd), y = users_rtd), position = position_stack(reverse = TRUE), stat = "identity", fill = pal[7]) +
  ylab("Number of accounts retweeted by user") +
  coord_flip() +
  theme_bw() +
  labs(title="Number of other accounts retweeted", subtitle = "June 24 - 27, Top 50 Users") +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_blank(),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))

```

<!-- ### Number of followers -->

```{r, fig.height=10, echo=FALSE, warning=FALSE, include = FALSE, fig.alt = "Histogram showing distribution of follower counts for all accounts that tweeted at least once using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. The median number of followers is approximately 650; the minimum is 4, and the maximum is 55k. The values in this figure are also included in the plain text tables lower on this page."}

followers <- dt_tweets %>%
  group_by(screen_name) %>%
  filter(!is_retweet) %>%
  arrange(desc(followers_count)) %>%
  filter(row_number() == 1)

smallaccts <- followers %>%
  filter(followers_count <250)

smalltweets <- dt_tweets %>%
  filter(followers_count < 250 & !is_retweet)

ggplot(followers, aes(followers_count)) +
  geom_histogram(fill = pal[7], bins = 50) +
  scale_x_log10() + xlab("Number of followers") +
  ylab("Number of users") +
  theme_bw() +
  labs(title="Number of Followers", subtitle = "June 24 - 27, All accounts using #Botany2022") +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_text(size = 12, family = "Open Sans"),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))

```

### Number of retweets of smaller accounts 
'Smaller' accounts is defined here as accounts with fewer than 250 followers. (This is approximately 25% of accounts using the hashtag.) Such smaller accounts collectively tweeted `r nrow(smalltweets)` of the `r sum(!dt_tweets$is_retweet)` original tweets using the #Botany2022 hashtag. The counts here are number of tweets, rather than number of accounts - each RT of a tweet from a small account is tallied here. 

```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing the number of times users retweeted tweets from smaller accounts using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. 'Smaller' accounts is defined here as accounts with fewer than 250 followers; this is roughly one quarter of all accounts using the hashtag during the conference. The values in this figure are also included in the plain text tables lower on this page. The figure includes all accounts that retweeted something from more than 1 'smaller' account. Top 5 - @SarraceniaMason (25), @Bethbo_beth (16), @kheyduk (12), @angelajmcd (12),, and @imenarv (11)"}
  
small <- dt_tweets %>% 
  group_by(screen_name) %>%
  filter(is_retweet & retweet_followers_count < 250) %>%
  summarize(rts_ct = sum(is_retweet)) %>%
  arrange(desc(rts_ct))

smallplot <- small %>%
  filter(rts_ct >1)

ggplot(smallplot) + 
  geom_bar(aes(x = reorder(screen_name, rts_ct), y = rts_ct), position = position_stack(reverse = TRUE), stat = "identity", fill = pal[7]) +
  ylab("Number of retweets of small accounts") +
  coord_flip() +
  theme_bw() +
  labs(title="Number of retweets of small accounts", subtitle = str_wrap("June 24 - 27, all users that retweeted an account with <250 followers more than once", 60)) +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_blank(),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))
```

### Number of small accounts tagged

```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing the number of times users tagged smaller accounts (within tweets and accounts using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022). 'Smaller' accounts is defined here as accounts with fewer than 250 followers; this is roughly one quarter of all accounts using the hashtag during the conference. The values in this figure are also included in the plain text tables lower on this page. Top 5 - @mossMatters (9), @imenarv (6), @JillWegrzyn (6), @vuruputoor (5), @MartineBotany (4)."}
  
tagged <- dt_tweets %>% 
  group_by(screen_name) %>%
  filter(!is_retweet) %>%
  separate_rows(mentions_screen_name, sep = " ") %>%
  summarize(users_tagged = n_distinct(mentions_screen_name)) %>%
  arrange(desc(users_tagged))

tags <- dt_tweets %>% 
  group_by(screen_name) %>%
  filter(!is_retweet & mentions_screen_name != "") %>%
  separate_rows(mentions_screen_name, sep = " ") %>%
  select(screen_name, mentions_screen_name, status_url)

followers2 <- followers %>% select(screen_name, followers_count)

tags_follows <- left_join(tags, followers2, by = c("mentions_screen_name" = "screen_name")) %>%
  drop_na(followers_count) #this functionally omits any tags of accounts that did not ever use the #Botany2022 hashtag, since they are not within this dataset to find a follower count

small_tags <- tags_follows %>%
  filter(followers_count < 250) %>%
  group_by(screen_name) %>%
  summarize(ntags = n()) %>%
  arrange(desc(ntags))

ggplot(small_tags) + 
  geom_bar(aes(x = reorder(screen_name, ntags), y = ntags), position = position_stack(reverse = TRUE), stat = "identity", fill = pal[7]) +
  ylab(str_wrap("Number of mentions of an account with <250 followers", 60)) +
  coord_flip() +
  theme_bw() +
  labs(title="Number of mentions of a small account", subtitle = str_wrap("June 24 - 27, all users that mentioned at least one small account", 80)) +
  scale_y_continuous(breaks = seq(from = 1, to = max(small_tags$ntags, by = 1))) +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_blank(),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))

```


## 4. Number of tweets

### Only for original tweets (retweets excluded)

```{r, top-users-orig, echo=FALSE, fig.height=10, warning=FALSE, fig.alt = "Bar plot showing number of tweets, excluding retweets, using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the number of tweets by a particular user, for the most prolific 50 users. The top 5 users are @SarraceniaMason (56 tweets), @MartineBotany (51 tweets), @ejrollinson (45 tweets), @M_Gostel (40 tweets), and @mossMatters (38 tweets). The values in this figure are also included in the plain text tables lower on this page."}
top_orig_users <- dt_tweets %>% group_by(screen_name) %>%
  summarize(total_tweets = n(),
            Retweet = sum(is_retweet),
            Original = sum(!is_retweet),
            .groups="drop_last") %>%
  arrange(desc(Original)) %>%
  slice(1:50)

top_orig_users$screenName <- reorder(top_orig_users$screen_name,
                                     top_orig_users$Original,
                                     function(x) sum(x))

ggplot(top_orig_users) + geom_bar(aes(x = screenName, y = Original), stat = "identity", fill=pal[7]) +
  ylab("Number of tweets") +
  coord_flip() +
    theme_bw() +
    labs(title="Most #Botany2022 Tweets (excluding retweets)", subtitle = "June 24 - 27, Top 50 Users") +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_blank(),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))

```

### All generated tweets (including retweets)

```{r top-users-all, echo=FALSE, fig.height=10, warning=FALSE, fig.alt = "Bar plot showing number of tweets, including retweets, using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the number of tweets by a particular user, for the most prolific 50 users. The top 5 users are @SarraceniaMason (359 tweets), @MartineBotany (181 tweets), @Bethbo_beth (145 tweets), @angelajmcd (126 tweets), and @kheyduk (103 tweets). The values in this figure are also included in the plain text tables lower on this page."}
top_users <- dt_tweets %>% group_by(screen_name) %>%
  summarize(total_tweets = n(),
            Retweets = sum(is_retweet),
            Original = sum(!is_retweet),
            .groups="drop_last") %>%
  arrange(desc(total_tweets)) %>%
  slice(1:50) %>%
  gather(type, n_tweets, -screen_name, -total_tweets)

top_users$screen_name <- reorder(top_users$screen_name,
                                top_users$total_tweets,
                                function(x) sum(x))

pal <- brewer.pal(9, "YlGnBu")

ggplot(top_users) + 
  geom_bar(aes(x = screen_name, y = n_tweets, fill = type), 
                             position = position_stack(reverse = TRUE), 
                             stat = "identity") +
  ylab("Number of tweets") +
  coord_flip() +
  scale_fill_manual(values = pal[c(7, 4)]) +
  theme_bw() +
  labs(title="Most #Botany2022 Tweets (including retweets)", subtitle = "June 24 - 27, Top 50 Users") +
  theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"),
        legend.text = element_text(size = 12, family="Open Sans"),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 12, family = "Open Sans"),
        axis.title.y = element_blank(),
        plot.title= element_text(size=14, family="Open Sans", color="black"),
        plot.subtitle = element_text(size=12, family="Open Sans", color="black"))
```

## 5. The 5 most liked tweets

```{r top-fav, echo=FALSE, results='asis', warning=FALSE}
top_fav <- dt_tweets %>%
  filter(!is_retweet) %>%
  arrange(desc(favorite_count)) %>%
  slice(1:5)
likes <-  as.data.frame(top_fav)
likelist <- likes$status_url

include_tweet(likelist[1])
include_tweet(likelist[2])
include_tweet(likelist[3])
include_tweet(likelist[4])
include_tweet(likelist[5])

```


## 6. The 5 most retweeted tweets

```{r top-rt, echo=FALSE, results='asis', warning=FALSE}
top_rt <- dt_tweets %>%
  filter(!is_retweet) %>%
  arrange(desc(retweet_count)) %>%
  slice(1:5)
rts <- as.data.frame(top_rt)
rtslist <- rts$status_url

include_tweet(rtslist[1])
include_tweet(rtslist[2])
include_tweet(rtslist[3])
include_tweet(rtslist[4])
include_tweet(rtslist[5])

```

## 7. Word cloud

The top 100 words among the original tweets, excluding retweets, hashtags, mentions, URLs, and common English words ("the', "&", etc.).


```{r word-cloud, echo=FALSE, message=FALSE, warning=FALSE, fig.alt = "Word cloud showing the most common words found in original tweets (not retweets) using #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022, excluding common English words like 'the' and 'and'. The complete corpus of words used to generate this word cloud, along with their frequency, is also shown in the plain text table lower on this page."}
library(wordcloud)
library(tm)
library(stringr)
library(ghibli)
library(qdapRegex)

palcloud <-brewer.pal(9, "YlGnBu")

cleaned <- dt_tweets %>%
  filter(!is_retweet) %>%
  .$text %>%
  str_c() %>%
  str_remove("\\n") %>%
  rm_twitter_url() %>%
  rm_url() %>%
  str_remove_all("#\\S+") %>%
  str_remove_all("@\\S+") %>%
  removeWords(stopwords("english")) %>%
  removeNumbers() %>%
  stripWhitespace() %>%
  removePunctuation() %>%
  removeWords(c("amp")) %>%
  str_remove("uff") %>%
  str_remove("â") %>%
  str_remove("use") %>%
  str_remove("its") %>%
  str_remove("edt")

#stopwords() removes common english words; remaining str_remove() lines clean up some remaining junk and common words  
corpus <- Corpus(VectorSource(cleaned)) %>%
  TermDocumentMatrix() %>%
  as.matrix()

corpus <- sort(rowSums(corpus), decreasing=TRUE)
corpus <- data.frame(word=names(corpus), freq=corpus, row.names=NULL)
corpus <- corpus %>%
  filter(word != "its" & word != "edt" & word != "the" & word != "this" & word != "i€™m" & word !="and") #catching common words that were for whatever reason not removed by stopwords and str_remove above

wordcloud(corpus$word, corpus$freq, max.words=100, colors = palcloud[5:9], random.order = FALSE, scale = c(4, 0.9), rot.per=0, fixed.asp=FALSE)

```

<!-- ## Most liked/retweeted users -->

<!-- The figures below only include users who tweeted 5+ times, and don't include retweets. -->

<!-- ### Number of likes received by users -->

<!-- ```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing number of favorites received by users on tweets using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the number of favorites on tweets by a particular user, for the most favorited 50 users. The values in this figure are also included in the plain text tables lower on this page."} -->
<!-- impact <- dt_tweets %>% filter(!is_retweet) %>% -->
<!--   group_by(screen_name) %>% -->
<!--   summarize(n_tweets = n(), -->
<!--             n_fav = sum(favorite_count), -->
<!--             n_rt =  sum(retweet_count), -->
<!--             mean_fav = mean(favorite_count), -->
<!--             mean_rt = mean(retweet_count), -->
<!--             .groups="drop_last") -->
<!-- ### Most favorited -->
<!-- most_fav <- impact %>% -->
<!--   arrange(desc(n_fav)) %>% -->
<!--   slice(1:50) -->

<!-- most_fav$screen_name <- reorder(most_fav$screen_name, -->
<!--                                most_fav$n_fav, -->
<!--                                sort) -->

<!-- ggplot(most_fav) + geom_bar(aes(x = screen_name, y = n_fav), -->
<!--                             stat = "identity", fill = pal[4]) + -->
<!--   coord_flip() + ylab("Total number of likes") + -->
<!--     theme_bw() + -->
<!--   theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"), -->
<!--         legend.text = element_text(size = 12, family="Open Sans"), -->
<!--         legend.title = element_blank(), -->
<!--         axis.title.x = element_text(size = 12, family = "Open Sans"), -->
<!--         axis.title.y = element_blank()) -->
<!-- ``` -->

<!-- ### Number of retweets received by users -->

<!-- ```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing number of retweets of tweets using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the number of retweets of tweets by a particular user, for the most retweeted 50 users. The values in this figure are also included in the plain text tables lower on this page."} -->
<!-- ## Most retweeted -->

<!-- most_rt <- impact %>% -->
<!--   arrange(desc(n_rt)) %>% -->
<!--   slice(1:50) -->

<!-- most_rt$screen_name <- reorder(most_rt$screen_name, -->
<!--                               most_rt$n_rt, -->
<!--                               sort) -->

<!-- ggplot(most_rt) + geom_bar(aes(x = screen_name, y = n_rt), -->
<!--                            stat = "identity", fill = pal[4]) + -->
<!--   coord_flip() + ylab("Total number of retweets") + -->
<!--   theme_bw() + -->
<!--   theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"), -->
<!--         legend.text = element_text(size = 12, family="Open Sans"), -->
<!--         legend.title = element_blank(), -->
<!--         axis.title.x = element_text(size = 12, family = "Open Sans"), -->
<!--         axis.title.y = element_blank()) -->
<!-- ``` -->

<!-- ### Mean numbers of likes received -->

<!-- ```{r, fig.height=10, echo=FALSE, warning=FALSE, fig.alt = "Bar plot showing mean number of likes received by tweets using the #Botany2022 hashtag between Sunday July 24 and Wednesday July 27, 2022. Each bar shows the mean number of likes on tweets by a particular user, for the most liked 50 users. The values in this figure are also included in the plain text tables lower on this page."} -->

<!-- ### Mean likes -->

<!-- hi_mean_fav <- impact %>% -->
<!--   arrange(desc(mean_fav)) %>% -->
<!--   slice(1:50) -->

<!-- hi_mean_fav$screen_name <- reorder(hi_mean_fav$screen_name, -->
<!--                                   hi_mean_fav$mean_fav, -->
<!--                                   sort) -->

<!-- ggplot(hi_mean_fav) + geom_bar(aes(x = screen_name, y = mean_fav), -->
<!--                            stat = "identity", fill = pal[4]) + -->
<!--   coord_flip() + ylab("Number of likes / tweets") + -->
<!--   theme_bw() + -->
<!--   theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"), -->
<!--         legend.text = element_text(size = 12, family="Open Sans"), -->
<!--         legend.title = element_blank(), -->
<!--         axis.title.x = element_text(size = 12, family = "Open Sans"), -->
<!--         axis.title.y = element_blank()) -->

<!-- ``` -->

<!-- ### Mean numbers of retweets received -->

<!-- ```{r, fig.height=10, echo=FALSE, warning=FALSE} -->

<!-- ### Mean retweets -->

<!-- hi_mean_rt <- impact %>% -->
<!--   arrange(desc(mean_rt)) %>% -->
<!--   slice(1:50) -->

<!-- hi_mean_rt$screen_name <- reorder(hi_mean_rt$screen_name, -->
<!--                                  hi_mean_rt$mean_rt, -->
<!--                                  sort) -->

<!-- ggplot(hi_mean_rt) + geom_bar(aes(x = screen_name, y = mean_rt), -->
<!--                            stat = "identity", fill =pal[5]) + -->
<!--   coord_flip() + xlab("User") + ylab("Number of retweets / tweets") + -->
<!--   theme_bw() + -->
<!--   theme(axis.text = element_text(size = 11, family = "Open Sans", color="black"), -->
<!--         legend.text = element_text(size = 12, family="Open Sans"), -->
<!--         legend.title = element_blank(), -->
<!--         axis.title.x = element_text(size = 12, family = "Open Sans"), -->
<!--         axis.title.y = element_blank()) -->


<!-- ``` -->

## 8. Data tables
Data tables for the figures above.

### Most accounts retweeted

```{r echo = FALSE, warning = FALSE}
table1 <- retweeters %>%
  select(screen_name, users_rtd) %>%
  arrange(desc(users_rtd))
paged_table(table1, options = list(rows.print=10))
```

### Number of retweets of small accounts
```{r echo = FALSE, warning = FALSE}
table5 <- small %>%
  select(screen_name, rts_ct) %>%
  arrange(desc(rts_ct))
paged_table(table5, options = list(rows.print=10))
```

### Number of mentions of small accounts
```{r echo = FALSE, warning = FALSE}
table6 <- small_tags %>%
  select(screen_name, ntags) %>%
  arrange(desc(ntags))
paged_table(table6, options = list(rows.print=10))
```

### Top tweeters, excluding retweets

```{r echo = FALSE, warning = FALSE}
table2 <- top_orig_users %>%
  select(screen_name, Original) %>%
  arrange(desc(Original))
paged_table(table2, options = list(rows.print=10))
```

### Top tweeters, including retweets

```{r echo = FALSE, warning = FALSE}
table3 <- top_users %>%
  spread(type,n_tweets) %>%
  arrange(desc(total_tweets))
paged_table(table3, options = list(rows.print=10))
```


### Corpus (Word cloud)
```{r echo = FALSE, warning = FALSE}
paged_table(corpus, options = list(rows.print=10))
```

<!-- ### Number of followers -->
```{r echo = FALSE, warning = FALSE, include = FALSE}
table4 <- followers %>%
  select(screen_name, followers_count) %>%
  arrange(desc(followers_count))
paged_table(table4, options = list(rows.print=10))
```


<!-- ### Number of favorites received by users -->

<!-- ```{r echo = FALSE, warning = FALSE} -->
<!-- table3 <- most_fav %>% -->
<!--   select(screen_name, n_tweets, n_fav) %>% -->
<!--   arrange(desc(n_fav)) -->
<!-- paged_table(table3, options = list(rows.print=10)) -->
<!-- ``` -->


<!-- ### Number of retweets received by users -->

<!-- ```{r echo = FALSE, warning = FALSE} -->
<!-- table4 <- most_rt %>% -->
<!--   select(screen_name, n_tweets, n_rt) %>% -->
<!--   arrange(desc(n_rt)) -->
<!-- paged_table(table4, options = list(rows.print=10)) -->
<!-- ``` -->

<!-- ### Mean numbers of likes received -->

<!-- ```{r echo = FALSE, warning = FALSE} -->
<!-- table5 <- hi_mean_fav %>% -->
<!--   select(screen_name, n_tweets, mean_fav) %>% -->
<!--   arrange(desc(mean_fav)) -->
<!-- table5$mean_fav <- as.integer(table5$mean_fav) -->
<!-- paged_table(table5, options = list(rows.print=10)) -->
<!-- ``` -->


<!-- ### Mean numbers of retweets received -->

<!-- ```{r echo = FALSE, warning = FALSE} -->
<!-- table6 <- hi_mean_rt %>% -->
<!--   select(screen_name, n_tweets, mean_rt) %>% -->
<!--   arrange(desc(mean_rt)) -->
<!-- table6$mean_rt <- as.integer(table6$mean_rt) -->
<!-- paged_table(table6, options = list(rows.print=10)) -->
<!-- ``` -->


-----

<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license"
     href="https://creativecommons.org/share-your-work/public-domain/cc0/">
    <img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0" />
  </a>
  <br />
  To the extent possible under law,
  <a rel="dct:publisher"
     href="https://github.com/erollinson/erollinson.github.io">
    <span property="dct:title">Emily J. Rollinson</span></a>
  has waived all copyright and related or neighboring rights to
  <span property="dct:title">Summary of tweets at Botany 2022</span>.
This work is published from:
<span property="vcard:Country" datatype="dct:ISO3166"
      content="US" about="https://github.com/erollinson/erollinson.github.io">
  United States</span>.
</p>

